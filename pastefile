using System;

namespace BlueZoneScreenScraping
{
    class Program
    {
        static void Main()
        {
            try
            {
                // Create an instance of the BlueZone COM object
                dynamic blueZone = Activator.CreateInstance(Type.GetTypeFromProgID("BZWhll.WhllObj"));
                
                // Connect to the session
                blueZone.Connect("A"); // Replace "A" with your session name
                
                // Read data from the screen (e.g., first 80 characters on row 1)
                string screenData = blueZone.ReadScreen(1, 1, 80);
                Console.WriteLine("Screen Data: " + screenData);

                // Example: Write data to a field on the screen
                blueZone.WriteScreen("Hello", 1, 1);
                
                // Disconnect
                blueZone.Disconnect();
            }
            catch (Exception ex)
            {
                Console.WriteLine("Error: " + ex.Message);
            }
        }
    }
}
