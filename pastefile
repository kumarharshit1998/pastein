' Enhanced test script to connect to BlueZone session and retrieve text from fixed coordinates

On Error Resume Next

' Create BlueZone session object
Set bzSession = CreateObject("BZWhll.WhllObj")

' Check if the object was created successfully
If Err.Number <> 0 Then
    WScript.Echo "Failed to create BlueZone object. Scripting may not be enabled."
    WScript.Quit
End If

' Connect to BlueZone session (using session A; adjust if needed)
bzSession.Connect "A"

' Check if connection was successful
If bzSession.connected Then
    ' Display some session properties to confirm connection
    WScript.Echo "Connected to BlueZone session."
    WScript.Echo "Screen width: " & bzSession.ScreenWidth
    WScript.Echo "Screen height: " & bzSession.ScreenHeight

    ' Optional: Add a small delay to ensure screen is fully loaded
    WScript.Sleep 1000  ' 1-second delay

    ' Attempt to get cursor position
    Dim cursorRow, cursorCol
    bzSession.GetCursorPos cursorRow, cursorCol

    ' Check if cursor position was retrieved
    If IsNumeric(cursorRow) And IsNumeric(cursorCol) Then
        WScript.Echo "Cursor is at row " & cursorRow & ", column " & cursorCol
    Else
        WScript.Echo "Failed to retrieve cursor position. Trying with fixed values."
        
        ' Try reading text from a fixed position (adjust as necessary)
        row = 5    ' Test row with known data
        col = 10   ' Test column with known data
        length = 20  ' Adjust the length as needed
        screenText = bzSession.CopyText(row, col, length)
        
        ' Display the retrieved text
        WScript.Echo "Text at (" & row & ", " & col & "): " & screenText
    End If
Else
    WScript.Echo "Failed to connect to BlueZone session."
End If

' Disconnect the session
bzSession.Disconnect
