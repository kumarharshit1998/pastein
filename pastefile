using System;
using System.Runtime.InteropServices;

class Program
{
    static void Main()
    {
        try
        {
            // Create an instance of BlueZone session
            dynamic bzSession = Activator.CreateInstance(Type.GetTypeFromProgID("BlueZone.Session"));

            // Make sure that the session object is created correctly
            if (bzSession == null)
            {
                Console.WriteLine("Failed to create BlueZone session object.");
                return;
            }

            // Connect to the BlueZone session (replace with actual hostname and port)
            bzSession.Connect("192.168.1.100", 23);

            // Check if the Screen object is accessible
            var screenData = bzSession.Screen.GetString(1, 1, 10);  // Get data from screen
            Console.WriteLine("Screen Data: " + screenData);

            // Disconnect when done
            bzSession.Disconnect();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error: {ex.Message}");
        }
    }
}
