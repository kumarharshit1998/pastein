using System;

namespace BlueZoneScreenScraping
{
    class Program
    {
        static void Main()
        {
            try
            {
                // Create an instance of the BlueZone COM object
                dynamic blueZone = Activator.CreateInstance(Type.GetTypeFromProgID("BZWhll.WhllObj"));
                
                // Connect to the session
                bool isConnected = blueZone.Connect("A"); // Replace "A" with your session name
                if (!isConnected)
                {
                    Console.WriteLine("Failed to connect to session.");
                    return;
                }

                // Debug: Check if connected
                Console.WriteLine("Connected to session.");

                // Read data from the screen
                try
                {
                    string screenData = blueZone.ReadScreen(1, 1, 80); // Adjust dimensions if needed
                    Console.WriteLine("Screen Data: " + screenData);
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Error while reading screen: " + ex.Message);
                }

                // Write data to the screen
                blueZone.WriteScreen("Hello", 1, 1);

                // Disconnect
                blueZone.Disconnect();
            }
            catch (Exception ex)
            {
                Console.WriteLine("General Error: " + ex.Message);
            }
        }
    }
}
