private async Task<byte[]> ObjectToByteArray(object obj)
{
    using var memoryStream = new MemoryStream();
    var jsonText = JsonConvert.SerializeObject(obj);
    using (var writer = new StreamWriter(memoryStream))
    {
        await writer.WriteAsync(jsonText);
        await writer.FlushAsync();
    }
    return memoryStream.ToArray();
}
