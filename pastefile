public class SHAWAutoFillModel
{
    public string AccountNumber { get; set; }

    // Dropdown Lists
    public List<SelectListItem> Sources { get; set; } = new List<SelectListItem>();
    public List<SelectListItem> Statuses { get; set; } = new List<SelectListItem>();

    // Selected Values
    public string SelectedSource { get; set; }
    public string SelectedStatus { get; set; }

    // Radio Button Selection
    public string AssignmentType { get; set; }  // "AssignToMe" or "NoAssignment"
}


public class SourceRepository
{
    private readonly ApplicationDbContext _dbContext;

    public SourceRepository(ApplicationDbContext dbContext)
    {
        _dbContext = dbContext;
    }

    public async Task<List<SelectListItem>> GetSourcesAsync()
    {
        var sourceList = await _dbContext.SawAutoFillSources
            .FromSqlRaw("EXEC usp_GetSources @MA = 'M'")
            .ToListAsync();

        return sourceList.Select(s => new SelectListItem
        {
            Value = s.REF_ID.ToString(),  // REF_ID as value
            Text = s.REF_DESC             // REF_DESC as dropdown text
        }).ToList();
    }
}


public class SHAWAutoFillController : Controller
{
    private readonly SourceRepository _sourceRepo;

    public SHAWAutoFillController(SourceRepository sourceRepo)
    {
        _sourceRepo = sourceRepo;
    }

    public async Task<IActionResult> Index()
    {
        var model = new SHAWAutoFillModel
        {
            Sources = await _sourceRepo.GetSourcesAsync(),
            Statuses = new List<SelectListItem>
            {
                new SelectListItem { Value = "", Text = "Choose Status", Selected = true },
                new SelectListItem { Value = "1", Text = "Value 1" },
                new SelectListItem { Value = "2", Text = "Value 2" },
                new SelectListItem { Value = "3", Text = "Value 3" },
                new SelectListItem { Value = "4", Text = "Value 4" }
            }
        };

        return View(model);
    }

    [HttpPost]
    public IActionResult Submit(SHAWAutoFillModel model)
    {
        if (ModelState.IsValid)
        {
            return Json(new 
            { 
                success = true, 
                message = "Successfully Submitted!", 
                data = new 
                { 
                    AccountNumber = model.AccountNumber,
                    SelectedSource = model.SelectedSource,
                    SelectedStatus = model.SelectedStatus,
                    AssignmentType = model.AssignmentType 
                }
            });
        }

        return Json(new { success = false, message = "Submission failed!" });
    }
}


@model SHAWAutoFillModel

<h2>SHAW Auto Fill</h2>

<form id="autoFillForm" asp-action="Submit" method="post">
    <div>
        <label>Account Number:</label>
        <input asp-for="AccountNumber" class="form-control" required />
    </div>

    <div>
        <label>Choose Source:</label>
        <select asp-for="SelectedSource" asp-items="Model.Sources" class="form-control">
            <option value="">Select Source</option>  <!-- Default -->
        </select>
    </div>

    <div>
        <label>Choose Status:</label>
        <select asp-for="SelectedStatus" asp-items="Model.Statuses" class="form-control">
        </select>
    </div>

    <div>
        <label>Assignment:</label><br>
        <input type="radio" asp-for="AssignmentType" value="AssignToMe" /> Assign to me
        <input type="radio" asp-for="AssignmentType" value="NoAssignment" /> No Assignment
    </div>

    <button type="submit" class="btn btn-primary">GO</button>
</form>

<hr />

<h3>Submitted Data</h3>
<div id="result"></div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $("#autoFillForm").submit(function (e) {
        e.preventDefault();
        
        $.post($(this).attr("action"), $(this).serialize(), function (response) {
            if (response.success) {
                $("#result").html(`
                    <p><b>Account Number:</b> ${response.data.AccountNumber}</p>
                    <p><b>Selected Source:</b> ${response.data.SelectedSource}</p>
                    <p><b>Selected Status:</b> ${response.data.SelectedStatus}</p>
                    <p><b>Assignment Type:</b> ${response.data.AssignmentType}</p>
                `);
            } else {
                alert(response.message);
            }
        });
    });
</script>


