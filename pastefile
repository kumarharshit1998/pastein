' Enhanced test script to connect to BlueZone session, retrieve cursor position, and read screen text

On Error Resume Next

' Create BlueZone session object
Set bzSession = CreateObject("BZWhll.WhllObj")

' Check if the object was created successfully
If Err.Number <> 0 Then
    WScript.Echo "Failed to create BlueZone object. Scripting may not be enabled."
    WScript.Quit
End If

' Connect to BlueZone session (using session A; adjust if needed)
bzSession.Connect "A"

' Check if connection was successful
If bzSession.connected Then
    ' Attempt to get cursor position
    Dim cursorRow, cursorCol
    bzSession.GetCursorPos cursorRow, cursorCol

    ' Check if cursor position was retrieved
    If IsNumeric(cursorRow) And IsNumeric(cursorCol) Then
        WScript.Echo "Cursor is at row " & cursorRow & ", column " & cursorCol

        ' Set row, column, and length for text retrieval
        row = cursorRow   ' Start at cursor row
        col = cursorCol   ' Start at cursor column
        length = 20       ' Number of characters to read; adjust as needed

        ' Retrieve text from the cursor position
        screenText = bzSession.CopyText(row, col, length)

        ' Display the retrieved text
        WScript.Echo "Text at cursor position (" & row & ", " & col & "): " & screenText
    Else
        WScript.Echo "Failed to retrieve cursor position. Please check the BlueZone session state."
    End If
Else
    WScript.Echo "Failed to connect to BlueZone session."
End If

' Disconnect the session
bzSession.Disconnect
