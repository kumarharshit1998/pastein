' Test script to check BlueZone session properties and retrieve text

On Error Resume Next

' Create BlueZone session object
Set bzSession = CreateObject("BZWhll.WhllObj")

' Check if the object was created successfully
If Err.Number <> 0 Then
    WScript.Echo "Failed to create BlueZone object. Scripting may not be enabled."
    WScript.Quit
End If

' Connect to BlueZone session (using session A; adjust if needed)
bzSession.Connect "A"

' Check if connection was successful
If bzSession.connected Then
    ' Display some session properties to confirm connection
    WScript.Echo "Connected to BlueZone session."
    WScript.Echo "Screen width: " & bzSession.ScreenWidth
    WScript.Echo "Screen height: " & bzSession.ScreenHeight

    ' Attempt to get cursor position
    Dim cursorRow, cursorCol
    bzSession.GetCursorPos cursorRow, cursorCol

    ' Check if cursor position was retrieved
    If IsNumeric(cursorRow) And IsNumeric(cursorCol) Then
        WScript.Echo "Cursor is at row " & cursorRow & ", column " & cursorCol
    Else
        WScript.Echo "Failed to retrieve cursor position. Trying with fixed values."
        
        ' If GetCursorPos fails, try reading text from a known location
        row = 5  ' Test row, adjust as needed
        col = 10 ' Test column, adjust as needed
        length = 20  ' Number of characters to read
        screenText = bzSession.CopyText(row, col, length)
        
        ' Display the retrieved text
        WScript.Echo "Text at (" & row & ", " & col & "): " & screenText
    End If
Else
    WScript.Echo "Failed to connect to BlueZone session."
End If

' Disconnect the session
bzSession.Disconnect
